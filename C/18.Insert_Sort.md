### 18. 插入排序

插入排序（Insertion sort）是一种简单直观且**稳定**的排序算法。

插入排序的核心在于"插入"两个字，将待排序数组中的元素逐个取出，然后将它们插入另一个数组，使得插入后的数组有序。当所有元素插入该数组后，整个数组是有序的，即完成了排序。

插入排序的过程有点像玩扑克牌时整理牌面的过程：发牌者每次发出一张牌，玩家每次得到一张牌，然后将这张牌插入手中的牌中，使得它们有序排列。当玩家把所有的牌插入自己的手牌后，手中的牌有序排列。

以序列`{2, 6, 9, 7, 4, 2, 5, 4}`为例，下图中(a)是插入排序的示意图：

<div align = center>
<img src = "https://img-blog.csdnimg.cn/20190921100012734.png" width = "80%">
<div align = left>

可以看到，将序列`{2, 6, 9, 7, 4, 2, 5, 4}`依次插入新序列后，整个序列有序，即完成了原序列的排序。

实际上，插入排序可以在原空间上进行排序，如图(b)所示，逐个将序列中的第`i`个元素插入前`i + 1`个元素构成的序列中即可完成排序。

因此，插入排序是**原址排序**。下面可以看到，插入排序的所需的辅助空间大小为`O(1)`。

下面是插入排序的C++实现：
```c
template<class T>
void insert_sort(std::vector<T>& vec) {
	int len = vec.size();
	for (int pos = 1; pos < len; ++pos) {
		T key = vec[pos];
		int i = pos - 1;
		while (i >= 0 && vec[i] > key) {
			vec[i + 1] = vec[i];
			i--;
		}
		vec[i + 1] = key;
	}
}
```
其中，值得注意的有下面几点：

**1.**`for(int pos = 1; pos < len; ++pos)`：`pos`表示当前要插入的元素的下标，此时前`pos`个元素已经有序。

**2.**`while(i >=0 && vec[i] > key)`：这里通过`while`循环挨个向前寻找插入位置，同时将大于等于`key`的元素后移。
